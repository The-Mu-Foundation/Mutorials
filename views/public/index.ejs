<%# Code for landing page %>
<%# ARGUMENTS: experience - an object containing ranking for XP %>

<%- include("../partials/header") -%>
<%- include("../partials/navigationPublic") -%>

<%- include("../partials/components/iconBar") -%>

<%# Jumbotron and contents inside %>

<script>

    window.onload = () => {

        // init AOS
        AOS.init({
            disable: function () {
                var maxWidth = 800;
                return window.innerWidth < maxWidth;
            },
            mirror: true
        });

        // render pie chart
        var ctxPassrate = document.getElementById("piechart");

        var style = ctxPassrate.style;
        style.marginLeft = "auto";
        style.marginRight = "auto";

        var myChart = new Chart(ctxPassrate, {
            type: "pie",
            data: {
                labels: ["Correct", "Wrong"],
                datasets: [{
                    label: "User Performance",
                    data: [Math.round(200+100*Math.random()), Math.round(100+100*Math.random())],
                    backgroundColor: [
                        "rgba(80, 185, 20, 1)",
                        "rgba(215, 80, 80, 1)"
                    ],
                    hoverBackgroundColor: [
                        "rgba(80, 185, 20, 1)",
                        "rgba(215, 80, 80, 1)"
                    ],
                    borderColor: [
                        "rgba(255, 255, 255, 0.5)",
                        "rgba(255, 255, 255, 0.5)"
                    ],
                    borderWidth: 2
                }]
            },
            options: {
                title: {
                    display: true,
                    text: "My Performance",
                    fontSize: 20
                },
                legend: {
                    display: false
                },
                cutoutPercentage: 40,
                responsive: true
            }
        });

        // render sample rating chart
        var ratingData = {
            "Physics": [1794, 1808, 1830, 1821, 1829, 1842, 1853, 1845, 1860, 1875, 1900, 1892, 1902, 1920, 1934, 1924, 1920, 1909, 1927, 1944],
            "Chemistry": [2103, 2119, 2130, 2139, 2150, 2143, 2154, 2137, 2122, 2135, 2111, 2098, 2082, 2076, 2085, 2074, 2061, 2048, 2059, 2050],
            "Biology": [1945, 1956, 1970, 1986, 1999, 2013, 2001, 2016, 2019, 2033, 2049, 2061, 2074, 2068, 2078, 2091, 2104, 2108, 2097, 2109],
            "Labels": []
        }

        const labelLength = Math.max(ratingData["Physics"].length, ratingData["Chemistry"].length, ratingData["Biology"].length);
        var labels = ratingData["Labels"];
        for(var i = labelLength; i > 0; i--) {
            labels.push(i + " Ago");
        }
        labels.push("");
        ratingData["Labels"] = labels;

        var ctxTracker = document.getElementById("sampleTrackerChart");

        var style = ctxTracker.style;
        style.marginLeft = "auto";
        style.marginRight = "auto";

        var myChart = new Chart(ctxTracker, {
            type: "line",
            data: {
                labels: ratingData["Labels"],
                datasets: [{
                    label: "Physics",
                    data: ratingData["Physics"],
                    backgroundColor: "rgba(100, 200, 230, 1)",
                    borderColor: "rgba(100, 200, 230, 1)",
                    fill: false,
                    borderWidth: 5
                }, {
                    label: "Chemistry",
                    data: ratingData["Chemistry"],
                    backgroundColor: "rgba(245, 170, 40, 1)",
                    borderColor: "rgba(245, 170, 40, 1)",
                    fill: false,
                    borderWidth: 5
                }, {
                    label: "Biology",
                    data: ratingData["Biology"],
                    backgroundColor: "rgba(40, 240, 110, 1)",
                    borderColor: "rgba(40, 240, 110, 1)",
                    fill: false,
                    borderWidth: 5
                }]
            },
            options: {
                title: {
                    display: true,
                    text: "My Rating Tracker",
                    fontSize: 20
                },
                legend: {
                    display: true,
                    position: "bottom"
                },
                scales: {
                    yAxes: [{
                        ticks: {
                            min: Math.round((Math.min(Math.min.apply(null, ratingData["Physics"]), Math.min.apply(null, ratingData["Chemistry"]), Math.min.apply(null, ratingData["Biology"]))-50)/50)*50,
                            max: Math.round((Math.max(Math.max.apply(null, ratingData["Physics"]), Math.max.apply(null, ratingData["Chemistry"]), Math.max.apply(null, ratingData["Biology"]))+50)/50)*50,
                            stepSize: 50
                        }
                    }],
                    xAxes: [{
                        ticks: {
                            display: false
                        }
                    }]
                },
                responsive: true
            }
        });
    };

    $(document).ready(function() {

        // animate cards
        $(".thumbnail").fadeTo(0, 0.8);
        $(".thumbnail").on({
            mouseenter: function() {
                $(this).fadeTo(200, 1);
            },
            mouseleave: function() {
                $(this).fadeTo(200, 0.8);
            }
        });

    });

    document.addEventListener('DOMContentLoaded', () => {
        var typed_options = {
            strings: ['free', 'challenging', 'adaptive', 'open-source'],
            typeSpeed: 40,
            backSpeed: 40,
            backDelay: 1500,
            startDelay: 500,
            loop: true,
            preStringTyped: (pos, self) => {
                $("#typed-a").html((pos > 1) ? "an" : "a");
            },
        };
        var typed = new Typed("#typed-span", typed_options);
        typed.start();
    });

</script>

<div class="container mt-5">

    <%- include("../partials/flashes") -%>

    <h1 class="text-center display-4"><strong>Mutorials</strong> is <span id="typed-a">a</span> <em id="typed-span"></em>science trainer.</h1>
    <h3 class="text-center" data-aos="zoom-out" data-aos-duration="500" data-aos-delay="500">Keep students motivated, engaged, and excellent!</h3>
</div>

<div class="container mt-5">

    <div class="jumbotron" data-aos="fade-right" data-aos-duration="500">

        <div class="row">

            <div class="col-7" data-aos="zoom-in" data-aos-duration="500" data-aos-delay="200">
                <div class="canvas-container-center text-center">
                    <canvas id="sampleTrackerChart" width="400" height="400" class=""></canvas>
                </div>
            </div>

            <div class="col-5" data-aos="zoom-in" data-aos-duration="500" data-aos-delay="300">

                <h1 class="text-center display-4">Detailed Analytics</h1>

                <div class="row">
                    <div class="col-2">
                    </div>
                    <div class="col-8">
                        <div class="canvas-container-center text-center">
                            <canvas id="piechart" width="400" height="400" class="mt-3"></canvas>
                        </div>
                    </div>
                    <div class="col-2">
                    </div>
                </div>

                <h3 class="mt-3 text-center">Performance Indicators</h3>
                <h3 class="text-center">Skillset Recommendations</h3>
                <h3 class="text-center">Comprehensive Reports</h3>
            </div>
        </div>

    </div>

    <div class="my-5 container" data-aos="fade-left" data-aos-duration="500">

        <div class="row">

            <div class="col-5">
                <h1 class="text-center display-4">Wide Coverage</h1>
                <h3 class="mt-3 text-center">Physics + Biology + Chemistry</h3>
                <h3 class="text-center">30 Distinct Units</h3>
                <h3 class="text-center">AP and IB Style Problems</h3>
            </div>

            <div class="col-7">

                <div class="row">

                    <div class="col-4" data-aos="flip-right" data-aos-duration="500" data-aos-delay="200">
                        <img id="physics-icon" class="thumbnail mu-rounded" src="https://f000.backblazeb2.com/file/mutorials/icons/Physics_Main.svg" alt="Physics icon">
                    </div>
            
                    <div class="col-4" data-aos="flip-right" data-aos-duration="500" data-aos-delay="300">
                        <img id="chem-icon" class="thumbnail mu-rounded" src="https://f000.backblazeb2.com/file/mutorials/icons/Chem_Main.svg" alt="Chem icon">
                    </div>
            
                    <div class="col-4" data-aos="flip-right" data-aos-duration="500" data-aos-delay="400">
                        <img id="bio-icon" class="thumbnail mu-rounded" src="https://f000.backblazeb2.com/file/mutorials/icons/Bio_Main.svg" alt="Bio icon">
                    </div>
            
                </div>

            </div>
            
        </div>

    </div>

    <div class="jumbotron" data-aos="fade-right" data-aos-duration="500">

        <div class="row">

            <div class="col-7">

                <div class="row">

                    <div class="col-4" data-aos="flip-right" data-aos-duration="500" data-aos-delay="200">
                        <img id="classic-icon" class="thumbnail mu-rounded" src="https://f000.backblazeb2.com/file/mutorials/icons/Train_Classic.svg" alt="Classic icon">
                    </div>
            
                    <div class="col-4" data-aos="flip-right" data-aos-duration="500" data-aos-delay="300">
                        <img id="rush-icon" class="thumbnail mu-rounded" width="100%" src="https://f000.backblazeb2.com/file/mutorials/icons/Train_Rush.svg" alt="Rush icon">
                    </div>
            
                    <div class="col-4" data-aos="flip-right" data-aos-duration="500" data-aos-delay="400">
                        <img id="daily-icon" class="thumbnail mu-rounded" src="https://f000.backblazeb2.com/file/mutorials/icons/Train_Daily.svg" alt="Daily icon">
                    </div>
    
                </div>
                
            </div>

            <div class="col-5">
                <h1 class="text-center display-4">Fun Gamemodes</h1>
                <h3 class="mt-3 text-center">Adaptive Classic Training</h3>
                <h3 class="text-center">Engaging Problem Rush</h3>
                <h3 class="text-center">Daily Challenge</h3>
            </div>
        </div>

    </div>
</div>

<div class="container">
    <%- include("../partials/components/siteStats") -%>
</div>

<div class="container jumbotron mt-5" data-aos="fade-left" data-aos-duration="500">

    <h1 class="text-center display-4">Learn & grow with the Mutorials community!</h1>

    <div class="row">

        <div class="col-5" data-aos="zoom-in" data-aos-duration="500" data-aos-delay="200">
            
            <table class="table mt-3">
                <thead>
                    <tr>
                        <th scope="col">Rank</th>
                        <th scope="col">Username</th>
                        <th scope="col">Level</th>
                        <th scope="col">Experience</th>
                    </tr>
                </thead>
                <tbody>
                    <% let rankExperience = 1; %>
                    <% experience.forEach((user) => { %>
                        <% let style = ""; %>
                        <% if(rankExperience == 1) { style = "background-color:#ffd700"; } %>
                        <% if(rankExperience == 2) { style = "background-color:#c0c0c0"; } %>
                        <% if(rankExperience == 3) { style = "background-color:#cd7f32"; } %>
                        <tr style=<%= style %>>
                            <th scope="row"><%= rankExperience %></th>
                            <td><%= user.ign.length <= 18 ? user.ign : user.ign.substring(0, 15)+"..." %></td>
                            <td><%= user.level.level %></td>
                            <td><%= Math.round(user.experience) %></td>
                        </tr>
                        <% rankExperience++; %>
                    <% }) %>
                </tbody>
            </table>
        </div>

        <div class="col-7" data-aos="zoom-in" data-aos-duration="500" data-aos-delay="300">

            <%- include("../partials/components/dailySnippet") -%>
        </div>

    </div>

</div>

<div class="container mt-5" data-aos="fade-up" data-aos-duration="500">
    <a class="btn btn-lg btn-block btn-primary" href="/signup">Start now!</a>
</div>

<div class="container my-5" data-aos="zoom-out" data-aos-duration="500">

    <footer class="text-center"><br><hr><br>Copyright © 2020 The Mu Foundation. All Rights Reserved.<br><a href='/termsOfService#terms-of-service'>Terms of Service</a> | <a href='/termsOfService#privacy-policy'>Privacy Policy</a></footer>

</div>

<%- include("../partials/footer") -%>
